# nendSDK 社内向け勉強会資料 -Deep編-
この資料は、事前にnend営業サイドからの質問を元に作成しています。

- [created 2019/03/20](https://gist.github.com/fan-t-fukuoka/6449180fbfd1fe047eec9bbea7af6e77)

## 目次
- [nendSDKの裏側の出来事](#about_back_side)
- [IDFA / GAIDの取得タイミング](#idfa_gaid)
- [AdMobメディエーションとMoPubカスタムイベントの違い](#difference_mediation_customevent)
- [レスポンスが早い理由は？](#response)
- [Q&A](#q&a)

## <a name ="about_back_side">広告の読み込みから表示されるまでの裏側の出来事</a>
### バナー
![capture_banner](https://user-images.githubusercontent.com/9563506/53944391-9b22cd00-4102-11e9-9840-769a58c5bdcc.png)
### インタースティシャル
![capture_interstitial](https://user-images.githubusercontent.com/9563506/53944392-9c53fa00-4102-11e9-9520-6af75e2d01c5.png)
### 静止画ネイティブ
![capture_native](https://user-images.githubusercontent.com/9563506/53944388-99590980-4102-11e9-9afc-4a186ecfb029.png)
### 静止画ネイティブV2
![native_v2](https://user-images.githubusercontent.com/9563506/53944379-96f6af80-4102-11e9-940c-908d2758513c.png)
### 動画
![video](https://user-images.githubusercontent.com/9563506/53944372-94945580-4102-11e9-9a31-ea2ae268fde6.png)

## <a name ="idfa_gaid">IDFA/GAIDの取得タイミング</a>
||広告初期化|広告リクエスト|インフォメーションボタンクリック（オプトアウト）|自動リロード|備考|
|:-:|:-:|:-:|:-:|:-:|:-:|
|バナー|-|◯|◯|◯|自動リロードの間隔は抽選リクエストの結果次第でデフォルト60秒|
|アイコン|-|◯|◯|◯|同上|
|インタースティシャル|-|◯|-|◯|自動リロードはデフォルト有効、広告が閉じた直後にリロード開始|
|静止画ネイティブ|-|◯|◯|◯|自動リロードはデフォルト無効、アプリ側で最小30秒〜指定可能|
|フルボード|-|◯|◯|-|-|
|動画|◯|◯|◯|-|-|
|動画ネイティブ|◯|◯|◯|-|-|

## <a name ="difference_mediation_customevent">AdMobメディエーションとMoPubカスタムイベントの違い</a>
|名称|正式連携|アダプタ開発|メディアへの提供|レポートAPIキー|
|:-:|:-:|:-:|:-:|:-:|
|AdMobメディエーション|○|nend|AdMob|○|
|MoPubカスタムイベント|×|nend|nend|×|

### 補足
#### カスタムイベントの方が設定手順が若干多い
メディエーションでもカスタムイベントでも、AdMobやMoPubの管理画面で、広告配信時に`nend`を認識してもらうための設定は必要。その際に、カスタムイベントの方が若干設定手順が多くなる。  

- 参考）https://github.com/fan-ADN/nendSDK-iOS-MoPub-CustomEvent/wiki/導入方法


#### 実装の手間はほぼ同じ
ただし、AdMobメディエーションとMoPubカスタムイベントでは、アプリに組み込む`アダプタが異なる`

## <a name ="response">レスポンスが早い（＝レイテンシーがない）のはなぜか？他社SDKとの違いは？</a>
- 他社と比較や調査をしたわけではなく、明確な違いを答えるのは難しい
- 基本的に、端末性能や通信状況などによってレスポンスの速度は異なるもの


## <a name ="q&a">Q&A

#### 静止画ネイティブの広告ロードの結果通知は必要か？
- 失敗時にアプリ側で制御を行うために必要と考える
- 広告がロードできなかった場合に表示を切り替える実装などアプリ側で行える

#### 静止画ネイティブのV1とV2の違いは？
- V1は実装する手間がV2よりも若干少ない
- V2は受け取った広告情報を自由にカスタマイズできる

#### 動画広告のエンドカードは、入稿されたバナーとストアから取ってくる方式があるがどのように判断しているか？
- 広告レスポンスの中で表示方法が決まる
- サーバー側で決めているためSDKでは判断していない

#### IDFA/GAIDについてインステではインフォメーションボタンクリックではなぜ取得していないか
- WebViewの機能を使っているため、WebViewではIDFA/GAIDを取得できないため

#### nendSDKの独自仕様は他と比べて多いのか？
- ほぼ他社と同じ（ロードの仕組みや通知の種類など）

#### 広告リクエストのエラーメッセージで在庫切れか？floor priceによるものか？を判断できないか
- サーバーから返ってくるのをアプリに返しているだけなのでSDKでは判別不能

#### Androidのインステをで 閉じるボタン（×ボタン）でしか閉じられない。Androidのバックキーで閉じられないか？
- 閉じられるはず（終了時広告のこと？終了時広告はできないようになっている）
  - 普通にバックキー押下でも閉じれる仕様になっています（後で再確認済み）
- インステの広告領域外で閉じられないかは管理画面で選択できる

#### SDKの動作がアプリのコンテンツに影響を及ぼすことはあるか？広告のロード等でアプリのコンテンツをいじってしまうことはある？
- 未知のバグはあるかもしれないが、アプリの操作を邪魔しないような作り（マルチタスク）になっている
- 正常であればアプリのコンテンツに影響は出ない

#### バックグラウンドで広告の呼び出しがあるがSDKで判別はつくか？(アドフラウド関連)
- 広告ロード＆クリックでアプリがバックグラウンドかを判定する機能はない
- バックグラウンドかどうかを判定してサーバーに送るような機能をSDKに追加すればできるかもしれない
